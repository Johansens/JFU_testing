on_actions = {
	on_startup = {
		effect = {
			if = { limit = {has_game_rule = {rule = horst_host_country option = ENG}} set_variable={host = ENG.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = GER}} set_variable={host = GER.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = ITA}} set_variable={host = ITA.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = ROM}} set_variable={host = ROM.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = HUN}} set_variable={host = HUN.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = FIN}} set_variable={host = FIN.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = USA}} set_variable={host = USA.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = CAN}} set_variable={host = CAN.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = SAF}} set_variable={host = SAF.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = RAJ}} set_variable={host = RAJ.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = AST}} set_variable={host = AST.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = NZL}} set_variable={host = NZL.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = CZE}} set_variable={host = CZE.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = YUG}} set_variable={host = YUG.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = JAP}} set_variable={host = JAP.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = MAN}} set_variable={host = MAN.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = SOV}} set_variable={host = SOV.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = FRA}} set_variable={host = FRA.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = SPR}} set_variable={host = SPR.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = NOR}} set_variable={host = NOR.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = ETH}} set_variable={host = ETH.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = EFR}} set_variable={host = EFR.id} }	
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = BUL}} set_variable={host = BUL.id} }
			else_if = { limit = {has_game_rule = {rule = horst_host_country option = BRA}} set_variable={host = BRA.id} }
			var:host = { set_variable = { marked_states = 0 } set_country_flag = host	}
			SWE = { HFU_fuel_startup_effect = yes }
			SWE = { JFU_startup_on_action = yes }
			SPR = {	country_lock_all_division_template = yes country_event = { id = lar_spain.2 days = 230 }}
			if = { 
				limit = {
					has_game_rule = {
						rule = JFU_closed_eco_JAPAN
						option = ENABLE_CLOSED_ECO
					}
				}
				JAP = {
					add_ideas = closed_economy 
					add_ideas = limited_exports_idea
				}
				
			}
			if = { 
				limit = {
					has_game_rule = {
						rule = JFU_closed_eco_SOVIET
						option = ENABLE_CLOSED_ECO
					}
				}
				SOV = {
					add_ideas = closed_economy 
					add_ideas = export_focus_idea
					403 = {
						add_extra_state_shared_building_slots = 8
						add_building_construction = {
							type = industrial_complex
							level = 8
							instant_build = yes
							}
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_pre_grinded_generals
						option = PRE_GRINDED_GENERALS_ON
					}
				}
				SWE = { JFU_pre_grinded_generals_ON = yes }
			}
			if = {
				limit = {
					NOT = {
						has_game_rule = {
							rule = JFU_pre_grinded_generals
							option = PRE_GRINDED_GENERALS_ON
						}
					}
				}
				SWE = { JFU_pre_grinded_generals_OFF = yes }
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_pre_grinded_generals
						option = HALVED_GRIND_TIME
					}
				}
				every_possible_country = {
					limit = {
						NOT = { ai_country = yes }
					}
					add_ideas = { HALVED_GRIND }
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_SPECIAL_FORCES_CAP
						option = JFU_DOUBLE_CAP
					}
				}
				every_possible_country = {
					limit = { 
						NOT = {
							ai_country = yes 
						}
					}
					add_ideas = DOUBLE_SF_CAP
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_SPECIAL_FORCES_CAP
						option = JFU_QUADRUPLE_CAP
					}
				}
				every_possible_country = {
					limit = { 
						NOT = {
							ai_country = yes 
						}
					}
					add_ideas = QUADRUPLE_SF_CAP
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_SPECIAL_FORCES_CAP
						option = JFU_NO_CAP
					}
				}
				every_possible_country = {
					limit = { 
						NOT = {
							ai_country = yes 
						}
					}
					add_ideas = NO_SF_CAP
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_DOWNTWIST_GAMECHANGES
						option = JFU_ALTERNATIVE_GS
					}
				}
				SWE = { JFU_alternative_gs = yes}
			}
		}
		
	}
	on_daily = {
		effect = {
			HFU_fuel_on_daily_scripted_effect = yes			
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_REICHSKOMMISSARIATS 
						option = JFU_STANDARD_RK
					}
				}
				if = { 
					limit = {
						original_tag = HOL
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = HOL
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_REICHSKOMMISSARIATS 
						option = JFU_STANDARD_RK
					}
				}
				if = { 
					limit = {
						original_tag = BEL
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = BEL
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_REICHSKOMMISSARIATS 
						option = JFU_STANDARD_RK
					}
				}
				if = { 
					limit = {
						original_tag = NOR
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = NOR
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_REICHSKOMMISSARIATS 
						option = JFU_STANDARD_RK
					}
				}
				if = { 
					limit = {
						original_tag = DEN
					}
					every_state = {
						limit = {
							AND = {
								is_core_of = DEN
								is_controlled_by = GER
							}
						}
					
						add_compliance = 50 
					}
				}
			}
			if = {
				limit = { 
				original_tag = POL

				}
				SOV = {transfer_state = 96 }
				SOV = {transfer_state = 95 }
				SOV = {transfer_state = 94 }
				SOV = {transfer_state = 784 }
				SOV = {transfer_state = 93 }
				SOV = {transfer_state = 91 }
				SOV = {transfer_state = 89 }
				SOV = {transfer_state = 97 }
				every_state = {
					limit = {
						AND = {
							is_core_of = POL
							is_controlled_by = GER
						}
					}
				
					set_compliance = 50 
				}
			}
			if = {
				limit = {
					original_tag = GRE
					ITA = { has_war_with = GRE }
				}
				add_threat = 10
				ITA = {
					transfer_state = 185
					transfer_state = 731
					transfer_state = 47
					transfer_state = 184
					transfer_state = 186
					transfer_state = 182
					transfer_state = 187
					every_state = {
             		   limit = {
              		     	is_core_of = GRE
             		      	is_controlled_by = ITA
              		 	}
              		  add_compliance = 50
		   			}
				}
			
			}
			if = {
				limit = {
					original_tag = CHI
					JAP = { has_war_with = CHI }
				}
				if = { 
					limit = {
						JAP = {
							has_country_flag = MAN_GETS_CHINA
						}
					
					}
					MAN = {
						annex_country = { target = CHI }
					}
					add_threat = 40
				}
				else = {
					JAP = {
						annex_country = { target = CHI }
					}
					add_threat = 40
				}			
			}
			if = {
				limit = {
					original_tag = FIN 
					SOV = { has_war_with = FIN}
				}
				white_peace = SOV
				SOV = {
					transfer_state = 722
					transfer_state = 147
					transfer_state = 146
					213_add = {
						add_extra_state_shared_building_slots = 10
						add_building_construction = {
							type = industrial_complex
							level = 5
							instant_build = yes
						}
						add_building_construction = {
							type = arms_factory
							level = 5
							instant_build = yes
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = YUG
					ITA = { has_war_with = YUG }
				}
				add_threat = 10
				HUN = {
					transfer_state = 45
					transfer_state = 764
				}
				ITA = {
					transfer_state = 102
					transfer_state = 103
					transfer_state = 104
					transfer_state = 105
					transfer_state = 106
					transfer_state = 107
					transfer_state = 108
					transfer_state = 109
					transfer_state = 804
					transfer_state = 802
					transfer_state = 803
					transfer_state = 102
				}
			}

			if = {
				limit = {
					original_tag = ETH
					ITA = {has_war_with = ETH}
				}
				
				ETH = {
					transfer_state = 271
					transfer_state = 550
					transfer_state = 559

					271 = { add_core_of = ETH }
					550 = { add_core_of = ETH }
					559 = { add_core_of = ETH }
				
					inherit_technology = ITA	
				}
			
				ITA = { puppet = ETH }	
			}
			if = {
				limit = {
					original_tag = SPR
				}
				set_global_flag = scw_over
				every_state = {
					limit = { 
						is_core_of = SPA
					}
					transfer_state_to = SPR 
				}

				SPR = {
					add_timed_idea = { idea = SPR_carlists_uprising days = 365 }
				}
				SOV = {
					remove_ideas = { SPR_seized_spanish_gold_reserves}
					add_ideas = { SPR_seized_spanish_gold_reserves }
				}

			}
			if = {
				limit = {
					original_tag = SPA 
				}
				every_state = {
					limit = { 
						AND = {
							is_core_of = SPA
							NOT = {
								is_controlled_by = SPD
							}
						}
					}
					transfer_state_to = SPR 
				}
			}
			if = {
				limit = {
					original_tag = SPD
				}
				every_state = {
					limit = { 
						AND = {
							is_core_of = SPR
							NOT = {
								is_controlled_by = SPA
							}
						}
					}
					transfer_state_to = SPR 
				}
				every_state = {
					limit = {
						AND = {
							is_core_of = SPR
							NOT = {
								is_controlled_by = SPR
							}
						}
					}
					transfer_state_to = SPA
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM = { tag = FRA }
					FROM.FROM = { is_core_of = FRA }
					OR ={  AND ={  FRA = { surrender_progress	> 0.32 NOT = { OR = { controls_state = 18 controls_state = 785 controls_state = 16 }} } }	FRA = { surrender_progress	> 0.5	}	 }
					NOT = { FRA = { has_country_flag = france_is_kill }}
				}

				tp_divs_out_of_france = yes 
 
				FRA = { 
					set_country_flag = france_is_kill  
					 set_capital = { state = 539 }
					country_event = { id = france.10 }
					set_global_flag = fall_of_france
					set_cosmetic_tag = FRA_FREE
					news_event = { id = news.34 days = 0 }
				

					if = { limit = { date > 1939.9.20 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.10.10 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.10.30 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.11.20 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.12.10 } add_to_variable = { var = FRA_legitimacy value = 5 } }
					
					if = { limit = { date > 1939.12.30 } add_to_variable = { var = FRA_legitimacy value = 5 } }

					set_temp_variable = { AXIScasualtiesk = 0 }
					add_to_temp_variable = { AXIScasualtiesk = ROM.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = ITA.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = HUN.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = GER.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = SPR.casualties_k }
					add_to_temp_variable = { AXIScasualtiesk = BUL.casualties_k }	
					divide_temp_variable  = { AXIScasualtiesk  = 3  }
					add_to_variable = { var = FRA_legitimacy value = AXIScasualtiesk }

				}

				JFU_vichy_france = yes
				
				ENG = { 
					retire_country_leader = yes					
					create_country_leader = {
						name = "Winston Churchill"
						desc = "POLITICS_WINSTON_CHURCHILL_DESC"
						picture = "Portrait_Britain_Winston_Churchill.dds"
						expire = "1965.1.1"
						ideology = conservatism
						traits = {	british_bulldog	}
					}

					add_stability = 0.1
					add_war_support = 0.1
				}
				GER = {  country_event = { id = france.14 }}
				if = {
					limit = { 
						AND = { 
							country_exists = JAP 
							SIA = { is_ai = yes} 
						}
					}
					JAP = {
						transfer_state = 670 
						transfer_state = 286 
						transfer_state = 741 
						transfer_state = 671 
						transfer_state = 728 
					}
				}
				if = { 
					limit = { 
						AND = { 
							country_exists = JAP 
							SIA = {is_ai = no }
						}
					}
					SIA = {
						transfer_state = 741
						transfer_state = 670
					}
					JAP = {
						transfer_state = 286
						transfer_state = 671
						transfer_state = 728
					}
					741 = { add_core_of = SIA }
					670 = { add_core_of = SIA}
				}
			}
			if = {
				limit = {
					446 = { is_controlled_by = ITA }
				}
				ITA = {
					add_ideas = ITA_VICTORY_IN_AFRICA	
				}
			}
			if = {
				limit = {
					AND = {
						NOT = { 446 = { is_controlled_by = ITA } }
						ITA = { has_idea = ITA_VICTORY_IN_AFRICA }
					}
				}
				remove_ideas = ITA_VICTORY_IN_AFRICA
			}
		}
	}
	on_paradrop = {
	    effect = {
			if = {  limit = { OR = { is_owned_by = SPR state = 118 } } ROOT = { PREV = {  teleport_armies = { to_state = FROM } } }	}
		}
	}
	on_naval_invasion = { effect ={  if = { limit = { spanish_coastline = yes } teleport_armies = {limit = { allies = yes  } to_state = FROM }  PREV = { if = { limit = { SPR = { owns_state = 41 } }transfer_state_to = SPR}  else = { transfer_state_to = GER }  }  } }   }	
	on_weekly_JAP = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_DOWNTWIST_GAMECHANGES
						option = JFU_ALTERNATIVE_GS
					}
					date > 1.1.1941
				}
				JAP = { island_hopping_JAP = yes }
			}
		}
	}
	on_weekly_USA = {
		effect = {
			if = {
				limit = {
					has_game_rule = {
						rule = JFU_DOWNTWIST_GAMECHANGES
						option = JFU_ALTERNATIVE_GS
					}
					date > 1.1.1941
				}
				USA = { island_hopping_USA = yes }
			}
		}
	}
}