
on_actions = {

	#### MIO on actions
	# ROOT is MIO
	on_mio_size_increased = {}
	# NB : all the following also exist at MIO level
	# use on-action here if the purpose is to execute for any MIO
	# use on-action at MIO level to execute just for one precise MIO
	# i.e. don't use this here : if = { limit = { is_military_industrial_organisation = ... } } }
	on_mio_design_team_assigned_to_tech = {}
	on_mio_design_team_assigned_to_variant = {}
	on_mio_industrial_manufacturer_assigned = {}
	on_mio_tech_research_cancelled = {}
	on_mio_tech_research_completed = {}
	on_mio_industrial_manufacturer_unassigned = {}


	#Not run on a specific country.
	on_startup = {
		effect = { # Setting up Nordic Cooperation system 
			NOR = {
				NORDIC_cooperation_initial_setup = yes 
			}
		}

		effect = {
			GER = {
				find_global_platonic_countries = yes # This is so platonic country variables are updated in game start and doesn't show as "Norway"
			}
		}
	}

	on_new_term_election = {
		random_events = {
			100 = denmark_political_events.3 #danish election events
		}
	}

	#ROOT is capitulated country, FROM is winner.
	on_capitulation_immediate = {

		#FINLAND - BROKEN CONTINUATION WAR PACT
		effect = {
			if = { #Finland or GER capitulating
				limit = {
					has_country_flag = FIN_pact_for_continuation_war_flag
				}
				#Send Event to Finland and to GER, regardless of who is ROOT
				country_event = AAT_finland_continuation_war.04
				random_other_country = {
					limit = {
						has_country_flag = FIN_pact_for_continuation_war_flag
					}
					country_event = AAT_finland_continuation_war.04
				}
			}
		}
	}
	
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = { #Achievement Two Arms Against Tyranny
			if = {
				limit = {
					has_dlc = "Arms Against Tyranny"
					FROM = {
						OR = {
							original_tag = FIN
							is_in_faction_with = FIN
						}
						num_faction_members < 3
						num_faction_members > 1
					}

					ROOT = {
						original_tag = SOV
					}
				}

				set_global_flag = capitulated_soviet_with_only_finland_and_another
			}
			if = { #Flag locking Achievement "Everything is Awesome"
				limit = {
					has_dlc = "Arms Against Tyranny"
					ROOT = {
						original_tag = DEN
					}
				}
				set_global_flag = achievement_den_has_never_been_capitulated
			}
		}
	}

	##ROOT is affected country
	on_uncapitulation = {
		effect = { # Setting Oslo as capital of Oslo again 
			if = {
				limit = {
					ROOT = { 
						original_tag = NOR
						has_government = democratic
						has_variable = NOR_mobile_government_hq
						NOT = {
							check_variable = {
								NOR_mobile_government_hq = 110 # Checking that the state is not Oslo 
							}  
						}
					}
				}
				ROOT = {
					set_capital = { state = 110}
					set_variable = { NOR_mobile_government_hq = 110 }
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = {
						tag = NOR
						has_country_flag = NOR_capitulation_prepared
						is_in_faction = yes 
					}
				}
				ROOT = {
					country_event = {
						id = AAT_norway.16
						hours = 4 
					}
				}
			}
		}
	}

	on_government_exiled = {
		#FINLAND - Remove BoP (agendas should not take effect while in exile)
		effect = {
			if = {
				limit = {
					original_tag = FIN
					has_power_balance = {
						id = FIN_power_balance
					}
				}
				remove_power_balance = {
					id = FIN_power_balance
				}
			}
		}
	}

	#Root is exile
	#From is old host 
	on_exile_government_reinstated = {
		#FINLAND - Bring back BoP
		effect = {
			if = {
				limit = {
					original_tag = FIN
					NOT = {
						has_power_balance = {
							id = FIN_power_balance
						}
					}
				}
				#Value based on present Sisu NS
				if = {
					limit = {
						has_idea = FIN_sisu_1
					}
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = -0.8
					}
				}
				else_if = {
					limit = {
						has_idea = FIN_sisu_2
					}
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = -0.3
					}
				}
				else_if = {
					limit = {
						has_idea = FIN_sisu_3
					}
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = 0
					}
				}
				else_if = {
					limit = {
						has_idea = FIN_sisu_4
					}
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = 0.3
					}
				}
				else_if = {
					limit = {
						has_idea = FIN_sisu_5
					}
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = 0.8
					}
				}
				else = { #Something weird happened and FIN doesn't have the Sisu NS -> Mid BoP and add Sisu NS
					set_power_balance = {
						id = FIN_power_balance
						left_side = FIN_bad_side
						right_side = FIN_good_side
						set_value = 0
					}
					add_ideas = FIN_sisu_3
				}
			}
		}
	}
	#ROOT = attacking side
	#FROM = defending side
	#fired when two countries end up at war with each other (on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first)
	on_war_relation_added = { # ---> Fires in 2nd place (1st is on_declare_war) -> This one is triggered ALWAYS 

		effect = {
			IF = {
				limit = {
					NOT = { has_global_flag = SOV_winter_war_flag }
					FROM = { tag = FIN }
					
				}
				set_variable = { FIN_white_death_target_country = ROOT }
			}
		}

		#FIN - Secret Pact for Continuation War (with GER)
		effect = { #ROOT = attacking side // FROM = defending side
			if = { #BARBAROSSA STARTS -> CONTINUATION WAR STARTS
				limit = {
					ROOT = { original_tag = GER }
					FROM = { original_tag = SOV }
					FIN = {
						exists = yes
						has_country_flag = FIN_pact_for_continuation_war_flag
						is_subject = no
						NOT = {
							is_in_faction_with = FROM
							has_subject = FROM
							has_non_aggression_pact_with = FROM
							has_guaranteed = FROM
						}
					}
				}
				FIN = {
					country_event = AAT_finland_continuation_war.05
				}
				ROOT = {
					country_event = AAT_finland_continuation_war.06
				}
				FROM = {
					country_event = AAT_finland_continuation_war.07
				}
				news_event = { id = aat_news.100 hours = 8 random_hours = 4 }
			}
			else_if = { #BARBAROSSA INVERTED STARTS (SOV declares on GER) -> CONTINUATION WAR STARTS
				limit = {
					ROOT = { original_tag = SOV }
					FROM = { original_tag = GER }
					FIN = {
						country_exists = yes
						has_country_flag = FIN_pact_for_continuation_war_flag
						is_subject = no
						NOT = {
							is_in_faction_with = ROOT
							has_subject = ROOT
							has_non_aggression_pact_with = ROOT
							has_guaranteed = ROOT
						}
					}
				}
				FIN = {
					country_event = AAT_finland_continuation_war.05
				}
				ROOT = {
					country_event = AAT_finland_continuation_war.07
				}
				FROM = {
					country_event = AAT_finland_continuation_war.06
				}
				news_event = { id = aat_news.100 hours = 8 random_hours = 4 }
			}
			else_if = { #FIN-GER at war, pact is broken
				limit = {
					OR = {
						AND = {
							ROOT = { original_tag = GER }
							FROM = { original_tag = FIN }
						}
						AND = {
							ROOT = { original_tag = FIN }
							FROM = { original_tag = GER }
						}
					}
					OR = {
						ROOT = { has_country_flag = FIN_pact_for_continuation_war_flag }
						FROM = { has_country_flag = FIN_pact_for_continuation_war_flag }
					}
				}
				# Send event
				if = {
					limit = {
						ROOT = { has_country_flag = FIN_pact_for_continuation_war_flag }
					}
					ROOT = { country_event = AAT_finland_continuation_war.04 }
				}
				if = {
					limit = {
						FROM = { has_country_flag = FIN_pact_for_continuation_war_flag }
					}
					FROM = { country_event = AAT_finland_continuation_war.04 }
				}
			}
		}
	}

	#	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					is_in_array = {
						array = FIN.core_states_at_game_start
						value = FROM.FROM
					}
				}

				set_global_flag = achievement_fin_has_lost_one_starting_core
			}
		}
		# FINNISH MOTTI - Remove Motti Tactics state modifier if Finland loses a state
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_dynamic_modifier = { modifier = FIN_motti_tactics_modifier }
					}
					FROM = { tag = FIN }
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = FIN_motti_tactics_modifier }
				}
				#Cost decrease for Motti decisions in Finland
				hidden_effect = {
					FROM = {
						divide_variable = { FIN_motti_decision_cost = FIN_motti_decision_cost_increase }
						set_variable = { FIN_motti_decision_cost_for_trigger = FIN_motti_decision_cost } #For trigger purposes
						subtract_from_variable = { FIN_motti_decision_cost_for_trigger = 1 } 
					}
				}
			}
		}

		#RENAME STATES/VPs
		effect = {
			IF = {
				limit = {
					FIN_state_or_vp_name_should_change = yes
				}
				FIN_change_name_of_state_or_vp = yes
			}
		}

		# FINNISH WEAPON CACHES - Communicate new controller about Finnish Weapon Caches if first time controlling state with this modifier
		effect = { #	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
			if = {
				limit = {
					FROM.FROM = {
						has_dynamic_modifier = { modifier = FIN_weapon_caches_modifier }
					}
					FROM = { tag = FIN }
				}
				#Communicate the new controller about the weapon caches only once
				if = {
					limit = {
						NOT = { has_country_flag = FIN_aware_about_weapon_caches_flag }
					}
					set_country_flag = FIN_aware_about_weapon_caches_flag
					set_variable = { FIN_state_with_weapon_caches = FROM.FROM }
					country_event = { id = AAT_finland_national_defense.01 hours = 1 }
				}
			}
		}

		# WINTER WAR - MISSION TO DEMAND PEACE (if pushing back) - FIN can no longer demand peace since they lost Leningrad
		effect = { #	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
			if = {
				limit = {
					FROM.FROM = { state = 195 } #LENINGRAD
					FROM = { has_country_flag = FIN_winter_war_ongoing_flag }
					FROM = { has_country_flag = FIN_can_demand_peace_negotiations_flag }
				}
				FROM = { clr_country_flag = FIN_can_demand_peace_negotiations_flag }
			}
		}

		# FINNISH PRESERVE SAPMI - If new SMI core controlled and focus is completed, add core of FIN.
		effect = { #	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
			if = {
				limit = {
					has_dlc = "Arms Against Tyranny"
					ROOT = {
						original_tag = FIN
						has_completed_focus = FIN_preserve_sapmi
						OR = {
							has_government = democratic
							has_government = communism
						}
					}
					FROM.FROM = {
						is_core_of = SMI
						NOT = { is_core_of = FIN }
					}
				}
				FROM.FROM = { add_core_of = ROOT }
			}
		}

		# FINNISH CONFEDERATED FINNO-RUSSIAN REPUBLICS
		effect = { #	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
			if = {
				limit = {
					has_dlc = "Arms Against Tyranny"
				}	
				if = {
					limit = {
						FROM.FROM = {
							has_dynamic_modifier = { modifier = FIN_confederation_of_finno_russian_republics_dm }
						}
						ROOT = {
							NOT = {
								original_Tag = FIN
								has_completed_focus = FIN_confederated_finno_russian_republics
							}
						}
					}
					FROM.FROM = {
						remove_dynamic_modifier = { modifier = FIN_confederation_of_finno_russian_republics_dm }
					}
				}
				else_if = {
					limit = {
						ROOT = {
							original_tag = FIN
							has_completed_focus = FIN_confederated_finno_russian_republics
						}
						FROM.FROM = {
							is_core_of = SOV
							NOT = { has_dynamic_modifier = { modifier = FIN_confederation_of_finno_russian_republics_dm } }
						}
					}
					FROM.FROM = {
						add_dynamic_modifier = { modifier = FIN_confederation_of_finno_russian_republics_dm }
					}
				}
			}
		}
		effect = { # Waiting for Norway to be over 50% conquered. 
			if = {
				limit = {
					FROM = {
						original_tag = NOR 
						NOT = { has_government = fascism }
						surrender_progress > 0.45
						has_completed_focus = NOR_continue_nygaardsvold_government 
						has_country_flag = NOR_delayed_quislings_coup
					}
				}
				FROM = {
					country_event = {
						id = AAT_norway.15
						hours = 2 
					}
				}
				clr_country_flag = NOR_delayed_quislings_coup
			}
		}
		#	ROOT is new controller, FROM is old controller, FROM.FROM is state ID.
	}

	on_ruling_party_change = {

		effect = { # FIN - Make sure country leaders have their appropriate party name
			if = {
				limit = {
					original_tag = FIN
				}
				if = {
					limit = {
						has_country_leader = {
							ruling_only = no
							character = FIN_kyosti_kallio
						}
					}
					set_party_name = { #Maalaisliitto (Agrarian League)
						ideology = neutrality
						name = FIN_neutrality_party
						long_name = FIN_neutrality_party_long
					}
				}
				else_if = {
					limit = {
						has_country_leader = {
							ruling_only = no
							character = FIN_risto_ryti
						}
					}
					set_party_name = { #National Progressive Party
						ideology = neutrality
						name = FIN_neutrality_party_progressive
						long_name = FIN_neutrality_party_progressive_long
					}
				}
				else_if = {
					limit = {
						has_country_leader = {
							ruling_only = no
							character = FIN_carl_mannerheim
						}
					}
					set_party_name = { #Non-Partisan Military Government
						ideology = neutrality
						name = FIN_neutrality_party_military
						long_name = FIN_neutrality_party_military_long
					}
				}
				else_if = {
					limit = {
						OR = {
							has_country_leader = {
								ruling_only = no
								character = FIN_pehr_evind_svinhufvud
							}
							has_country_leader = {
								ruling_only = no
								character = FIN_juho_kusti_paasikivi
							}
						}
					}
					set_party_name = { #Kokoomus (National Coalition Party)
						ideology = neutrality
						name = FIN_neutrality_party_kokoomus
						long_name = FIN_neutrality_party_kokoomus_long
					}
				}
				else_if = {
					limit = {
						has_country_leader = {
							ruling_only = no
							character = FIN_prince_wolfgang_von_hesse
						}
					}
					set_party_name = {
						ideology = neutrality
						long_name = FIN_neutrality_party_monarchist_long
						name = FIN_neutrality_party_monarchist
					}
				}
				else = { #Fallback is Agrarian League (Maalaisliitto)
					set_party_name = {
						ideology = neutrality
						name = FIN_neutrality_party
						long_name = FIN_neutrality_party_long
					}
				}
			}
		}

		effect = { # FIN - Deactivate BoP and bringing back old Sisu NS if changing ideology without AAT
			if = {
				limit = {
					NOT = { has_dlc = "Arms Against Tyranny" }
					original_tag = FIN
					NOT = {
						has_country_leader = {
							ruling_only = yes
							character = FIN_pehr_evind_svinhufvud
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_kyosti_kallio
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_risto_ryti
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_carl_mannerheim
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_juho_kusti_paasikivi
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_prince_wolfgang_von_hesse
						}
					}
				}
				if = { #Remove BoP and related Sisu NS
					limit = {
						has_power_balance = {
							id = FIN_power_balance
						}
					}
					remove_power_balance = { id = FIN_power_balance }
					if = {
						limit = {
							has_idea = FIN_sisu_1
						}
						remove_ideas = FIN_sisu_1
					}
					else_if = {
						limit = {
							has_idea = FIN_sisu_2
						}
						remove_ideas = FIN_sisu_2
					}
					else_if = {
						limit = {
							has_idea = FIN_sisu_3
						}
						remove_ideas = FIN_sisu_3
					}
					else_if = {
						limit = {
							has_idea = FIN_sisu_4
						}
						remove_ideas = FIN_sisu_4
					}
					else_if = {
						limit = {
							has_idea = FIN_sisu_5
						}
						remove_ideas = FIN_sisu_5
					}
				}

				if = { #Add old Sisu NS
					limit = {
						NOT = { has_idea = sisu }
					}
					add_ideas = sisu
				}
			}
		}

		effect = { #FIN - Drop cosmetic tags if appropriate
			if = { #RED FINLAND cosmetic
				limit = {
					has_cosmetic_tag = FIN_red_finland
					NOT = { has_government = communism }
				}
				drop_cosmetic_tag = yes
			}
			if = { #GRAND FINNISH FEDERATION cosmetic
				limit = {
					has_cosmetic_tag = FIN_grand_finnish_federation
					NOT = { has_government = democratic }
				}
				drop_cosmetic_tag = yes
			}
			if = { #GREATER FINLAND cosmetic
				limit = {
					has_cosmetic_tag = FIN_greater_finland
					OR = {
						has_government = democratic
						has_government = communism
					}
				}
				drop_cosmetic_tag = yes
			}
			if = { #CONFEDERATED FINNO-RUSSIAN REPUBLICS cosmetic
				limit = {
					has_cosmetic_tag = FIN_confederated_finno_russian_republics
					OR = {
						has_government = fascism
						has_government = neutrality
					}
				}
				drop_cosmetic_tag = yes
			}
			if = { #KINGDOM OF FINLAND cosmetic
				limit = {
					has_cosmetic_tag = FIN_kingdom_of_finland
					NOT = { has_government = neutrality }
				}
				drop_cosmetic_tag = yes
			}
		}
	}

	on_weekly_FIN = {
		#FINLAND BOP
		effect = {
			##################
			### SVINHUFVUD ###
			##################
			if = { #SVINHUFVUD - GOOD = No Democ & No Commie |||| BAD = Some Democ OR Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_pehr_evind_svinhufvud
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CONCERNING SUPPORT FOR SOCIALISTS
				if = {
					limit = {
						OR = {
							communism > 0.09
							democratic > 0.09
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_concerning_support_for_socialists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_eradicate_socialism
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_socialism
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_concerning_support_for_socialists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
				}
				#### GOOD ####
				#ERADICATE SOCIALISM
				if = {
					limit = {
						democratic < 0.01
						communism < 0.01
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_eradicate_socialism
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_socialism
						}
					}
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_concerning_support_for_socialists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_eradicate_socialism
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_socialism
						}
					}
				}
			}
			##################
			##### KALLIO #####
			##################
			else_if = { #KALLIO - GOOD = No Fascist & No Commie |||| BAD = Some Fascist OR Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_kyosti_kallio
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CONCERNING SUPPORT FOR EXTREMISTS
				if = {
					limit = {
						OR = {
							communism > 0.09
							fascism > 0.09
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_concerning_support_for_extremists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_extremists
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_eradicate_extremists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_extremists
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_concerning_support_for_extremists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_extremists
						}
					}
				}
				#### GOOD ####
				#ERADICATE EXTREMISTS
				if = {
					limit = {
						fascism < 0.01
						communism < 0.01
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_eradicate_extremists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_extremists
						}
					}
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_concerning_support_for_extremists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_extremists
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_eradicate_extremists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_eradicate_extremists
						}
					}
				}
			}
			###########################################################
			###### RYTI ############################## VON HESSE ######
			###########################################################
			else_if = { #RYTI - GOOD = Control Cores owned by enemies |||| BAD = Some Democ OR Commie // Losing Cores  ######## Also used for King von Hesse
				limit = {
					OR = {
						has_country_leader = {
							ruling_only = yes
							character = FIN_risto_ryti
						}
						has_country_leader = {
							ruling_only = yes
							character = FIN_prince_wolfgang_von_hesse
						}
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CONCERNING SUPPORT FOR SOCIALISTS
				if = {
					limit = {
						OR = {
							communism > 0.09
							democratic > 0.09
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_concerning_support_for_socialists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
				}
				else_if = {
					limit = {
						has_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
					remove_power_balance_modifier = {
						id = FIN_power_balance
						modifier = FIN_bop_modifier_concerning_support_for_socialists
					}
				}
				#### GOOD ####
				#DREAM OF GREATER FINLAND
				if = {
					limit = {
						any_core_state = {
							NOT = { is_owned_by = ROOT }
							is_controlled_by = ROOT
						}
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_dream_of_greater_finland
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_dream_of_greater_finland
						}
					}
				}
				else_if = {
					limit = {
						has_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_dream_of_greater_finland
						}
					}
					remove_power_balance_modifier = {
						id = FIN_power_balance
						modifier = FIN_bop_modifier_dream_of_greater_finland
					}
				}
			}
			##################
			### MANNERHEIM ###
			##################
			else_if = { #MANNERHEIM - GOOD = War |||| BAD = Peace
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_carl_mannerheim
					}
				}
				#### BAD ####
				#PEACE
				if = {
					limit = {
						has_war = no
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_appointed_regent
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_appointed_regent
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_reliable_leader
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_reliable_leader
						}
					}
				}
				#### GOOD ####
				#WAR
				else = {
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_reliable_leader
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_reliable_leader
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_appointed_regent
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_appointed_regent
						}
					}
				}
			}
			##################
			#### PAASIKIVI ###
			##################
			else_if = { #PAASIKIVI - GOOD = Very High Stab |||| BAD = Low Stab // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_juho_kusti_paasikivi
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CARETAKER
				if = {
					limit = {
						has_stability < 0.6
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_caretaker
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_caretaker
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_realist_conservative
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_realist_conservative
						}
					}
				}
				#### GOOD ####
				#WAR
				else_if = {
					limit = {
						has_stability > 0.95 
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_realist_conservative
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_realist_conservative
						}
					}
					#Remove opposite modifier if necessary
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_caretaker
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_caretaker
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_realist_conservative
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_realist_conservative
						}
					}
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_caretaker
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_caretaker
						}
					}
				}
			}
			##################
			##### ANNALA #####
			##################
			else_if = { #ANNALA - GOOD = Deployed MP and winning war |||| BAD = Some Democratic OR Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_vilho_annala
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CONCERNING SUPPORT FOR SOCIALISTS
				if = {
					limit = {
						OR = {
							communism > 0.09
							democratic > 0.09
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_concerning_support_for_socialists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
				}
				else_if = {
					limit = {
						has_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_socialists
						}
					}
					remove_power_balance_modifier = {
						id = FIN_power_balance
						modifier = FIN_bop_modifier_concerning_support_for_socialists
					}
				}

				#### GOOD ####
				#STRONG NATION
				if = {
					limit = {
						has_war = yes
						surrender_progress < 0.05
						has_army_manpower = { size > 299999 }
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_strong_nation
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_strong_nation
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_strong_nation
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_strong_nation
						}
					}
				}
			}
			##################
			##### TANNER #####
			##################
			else_if = { #TANNER - GOOD = High Democ Support |||| BAD = Some Fascist OR Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_vaino_tanner
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#CONCERNING SUPPORT FOR EXTREMISTS
				if = {
					limit = {
						OR = {
							communism > 0.09
							fascism > 0.09
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_concerning_support_for_extremists
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_extremists
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_concerning_support_for_extremists
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_concerning_support_for_extremists
						}
					}
				}

				#### GOOD ####
				#UNITED NATION
				if = {
					limit = {
						democratic > 0.95
						all_owned_state = {
							is_controlled_by = ROOT
						}
						controls_state = 146 #KARJALA
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_united_nation
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_united_nation
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_united_nation
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_united_nation
						}
					}
				}
			}
			####################
			##### AALTONEN #####
			####################
			else_if = { #AALTONEN - GOOD = Winning war against Fascists |||| BAD = Not high Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_aimo_aaltonen
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#DIVIDED PROLETARIAT
				if = {
					limit = {
						communism < 0.8
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_divided_proletariat
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_divided_proletariat
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_divided_proletariat
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_divided_proletariat
						}
					}
				}

				#### GOOD ####
				#ANTI-FASCIST CRUSADE
				if = {
					limit = {
						has_war = yes
						any_enemy_country = {
							has_government = fascism
						}
						surrender_progress < 0.05
						NOT = {
							any_war_score < 10
						}
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_anti_fascist_crusade
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_anti_fascist_crusade
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_anti_fascist_crusade
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_anti_fascist_crusade
						}
					}
				}
			}
			#################
			##### LEINO #####
			#################
			else_if = { #LEINO - GOOD = No Fascism in Europe |||| BAD = Not high Commie // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_yrjo_leino
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#DIVIDED PROLETARIAT
				if = {
					limit = {
						communism < 0.8
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_divided_proletariat
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_divided_proletariat
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_divided_proletariat
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_divided_proletariat
						}
					}
				}

				#### GOOD ####
				#OBLITERATED EUROPEAN FASCISM
				if = {
					limit = {
						fascism < 0.01
						all_country = { #No Fascist country in Europe
							OR = {
								NOT = { has_government = fascism }
								capital_scope = {
									NOT = { is_on_continent = europe }
								}
							}
						}
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_obliterated_european_fascism
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_obliterated_european_fascism
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_obliterated_european_fascism
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_obliterated_european_fascism
						}
					}
				}
			}
			####################
			##### KUUSINEN #####
			####################
			else_if = { #KUUSINEN - GOOD = Scandinavian and Baltic allies |||| BAD = No Kola & Karelia // Losing Cores
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = FIN_otto_wille_kuusinen
					}
				}
				#### BAD ####
				#LOSING CORES
				FIN_check_and_manage_losing_cores_for_bop_effect = yes

				#FORGOTTEN FINNO-KARELIANS
				if = {
					limit = {
						OR = {
							NOT = { controls_state = 146 } #KARJALA
							NOT = { controls_state = 213 } #KOLA
							NOT = { controls_state = 215 } #ONEGA
							NOT = { controls_state = 216 } #OLONETS
						}
					}
					#Add modifier (only once)
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_forgotten_finno_karelians
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_forgotten_finno_karelians
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_forgotten_finno_karelians
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_forgotten_finno_karelians
						}
					}
				}

				#### GOOD ####
				#SOLAR SYSTEM OF ORGANIZATIONS
				if = {
					limit = {
						NOR = {
							all_core_state = {
								OR = {
									is_controlled_by = ROOT
									controller = {
										is_in_faction_with = ROOT
									}
								}
							}
						}
						LIT = {
							all_core_state = {
								OR = {
									is_controlled_by = ROOT
									controller = {
										is_in_faction_with = ROOT
									}
								}
							}
						}
					}
					if = {
						limit = {
							NOT = {
								has_power_balance_modifier = {
									id = FIN_power_balance
									modifier = FIN_bop_modifier_a_solar_system_of_organizations
								}
							}
						}
						add_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_a_solar_system_of_organizations
						}
					}
				}
				else = {
					if = {
						limit = {
							has_power_balance_modifier = {
								id = FIN_power_balance
								modifier = FIN_bop_modifier_a_solar_system_of_organizations
							}
						}
						remove_power_balance_modifier = {
							id = FIN_power_balance
							modifier = FIN_bop_modifier_a_solar_system_of_organizations
						}
					}
				}
			}
			# UNKNOWN LEADER -> KILL BOP
			else = {
				remove_power_balance = {
					id = FIN_power_balance
				}
			}

			#### CLEAN ANY OBSOLETE BOP MODIFIERS (based on country leader)
			FIN_clean_all_obsolete_bop_modifiers_effect = yes
		}
	}
}